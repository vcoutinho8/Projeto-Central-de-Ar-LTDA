<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel ADM | Central de Ar LTDA</title>
  <!-- Carregando o Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
   <link
      rel="icon"
      href="https://cdn-icons-png.flaticon.com/512/1684/1684375.png"
    />
  <!-- Adicionando a fonte Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    /* Oculta a barra de rolagem padrão do Chrome/Safari */
    .sidebar-scroll::-webkit-scrollbar {
      display: none;
    }

    /* Oculta a barra de rolagem do Firefox */
    .sidebar-scroll {
      -ms-overflow-style: none;
      /* IE e Edge */
      scrollbar-width: none;
      /* Firefox */
    }
    
    /* Estilo para as linhas alternadas da tabela (para relatórios) */
    .table-body tr:nth-child(even) {
        background-color: #f9fafb; /* bg-gray-50 */
    }
  </style>
</head>

<body class="bg-gray-100 antialiased">

  <div class="flex h-screen bg-gray-100">

    <!-- 1. Sidebar (Menu Lateral Fixo) -->
    <aside
      class="w-64 bg-white shadow-lg flex flex-col fixed inset-y-0 left-0 z-20 transform md:translate-x-0 -translate-x-full transition-transform duration-300 ease-in-out"
      id="sidebar">

      <!-- Logo Header -->
      <div class="flex items-center justify-center h-20 border-b border-gray-200 flex-shrink-0">
        <a href="#page-dashboard" class="nav-link" data-target="page-dashboard">
          <img src="/backend e arquivo.bak/fastapi_crud/frontend/img/logopng.png"
            onerror="this.src='https://placehold.co/200x50/cccccc/333333?text=Logo+ADM'" alt="Logo Admin"
            class="h-20 w-auto">
        </a>
      </div>

      <!-- Menu de Navegação -->
      <nav class="flex-1 overflow-y-auto sidebar-scroll">
        <ul class="py-4">
          <!-- Item Dashboard (Home) -->
          <li>
            <a href="#page-dashboard"
              class="nav-link flex items-center px-6 py-3 text-gray-700 bg-blue-50 border-l-4 border-blue-600 font-medium"
              data-target="page-dashboard">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                </path>
              </svg>
              Dashboard
            </a>
          </li>
          <!-- Item Produtos -->
          <li>
            <a href="#page-produtos"
              class="nav-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-50 border-l-4 border-transparent"
              data-target="page-produtos">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 7v8a2 2 0 002 2h4a2 2 0 002-2V7a2 2 0 00-2-2h-4A2 2 0 008 7z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M16 7a4 4 0 014 4v4a4 4 0 01-4 4H8a4 4 0 01-4-4V11a4 4 0 014-4h1"></path>
              </svg>
              Produtos
            </a>
          </li>
          <!-- Item Clientes -->
          <li>
            <a href="#page-clientes"
              class="nav-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-50 border-l-4 border-transparent"
              data-target="page-clientes">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 016-6h6m6 0a1 1 0 001-1v-4a1 1 0 00-1-1h-4a1 1 0 00-1 1v4a1 1 0 001 1z">
                </path>
              </svg>
              Clientes
            </a>
          </li>
          <!-- Item Vendedores -->
          <li>
            <a href="#page-vendedores"
              class="nav-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-50 border-l-4 border-transparent"
              data-target="page-vendedores">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
              Vendedores
            </a>
          </li>
          <!-- ADICIONADO: Item Relatórios -->
          <li>
            <a href="#page-relatorios"
              class="nav-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-50 border-l-4 border-transparent"
              data-target="page-relatorios">
              <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                </path>
              </svg>
              Relatórios
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Overlay (para fechar sidebar no mobile) -->
    <div class="fixed inset-0 bg-black/30 z-10 hidden md:hidden" id="sidebar-overlay"></div>

    <!-- 2. Conteúdo Principal (Onde as páginas carregam) -->
    <div class="flex-1 flex flex-col ml-0 md:ml-64 transition-all duration-300 ease-in-out">

      <!-- Header do Conteúdo (com Perfil e Menu Mobile) -->
      <header
        class="bg-white shadow-sm border-b border-gray-200 h-20 flex items-center justify-between px-6 flex-shrink-0">
        <!-- Botão Menu Mobile -->
        <button class="md:hidden text-gray-600" id="menu-toggle-btn">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>

        <!-- Título da Página (será atualizado via JS) -->
        <h1 class="text-2xl font-semibold text-gray-800" id="page-title">Dashboard</h1>

        <!-- Menu do Usuário (Perfil/Sair) -->
        <div class="relative">
          <button id="user-menu-button" class="flex items-center space-x-2 text-gray-600 focus:outline-none">
            <img class="w-8 h-8 rounded-full" src="https://placehold.co/40x40/e0f2fe/4a5568?text=A" alt="Avatar Admin">
            <span class="hidden md:block font-medium">Admin</span>
            <svg class="w-4 h-4 hidden md:block text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>

          <!-- Dropdown de Logout -->
          <div id="user-menu-dropdown"
            class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-xl z-50 border border-gray-100">
            <div class="py-1">
              <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Meu Perfil</a>
              <a href="/backend e arquivo.bak/fastapi_crud/telaprincipal.html" class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50 font-medium">
                Fazer Logout
              </a>
            </div>
          </div>
        </div>
      </header>

      <!-- Área de Conteúdo (páginas) -->
      <main class="flex-1 overflow-y-auto p-6 md:p-10">

        <!-- ==== PÁGINA 1: DASHBOARD (Home) ==== -->
        <div class="page-content" id="page-dashboard">
          <!-- Cards de Estatística -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Card 1: Total de Produtos -->
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100">
              <h3 class="text-sm font-medium text-gray-500">Total de Produtos</h3>
              <p class="text-3xl font-bold text-gray-800 mt-2" id="total-produtos">--</p>
              <p class="text-sm text-gray-500 mt-1">Produtos cadastrados</p>
            </div>
            <!-- Card 2: Total de Clientes -->
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100">
              <h3 class="text-sm font-medium text-gray-500">Total de Clientes</h3>
              <p class="text-3xl font-bold text-gray-800 mt-2" id="total-clientes">--</p>
              <p class="text-sm text-gray-500 mt-1">Clientes cadastrados</p>
            </div>
            <!-- Card 3: Vendedores Ativos -->
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100">
              <h3 class="text-sm font-medium text-gray-500">Vendedores Ativos</h3>
              <p class="text-3xl font-bold text-gray-800 mt-2" id="total-vendedores">--</p>
              <p class="text-sm text-gray-500 mt-1">Vendedores cadastrados</p>
            </div>
          </div>
        </div>

        <!-- ==== PÁGINA 2: PRODUTOS (CRUD) ==== -->
        <!-- Conteúdo migrado do seu arquivo "funcional" e re-estilizado -->
        <div class="page-content hidden" id="page-produtos">
          <!-- Formulário de Criação -->
          <section class="bg-white shadow-lg rounded-lg p-6 mb-8 border border-gray-100">
            <h2 class="text-2xl font-semibold mb-5 text-gray-800">Adicionar Novo Produto</h2>
            <div class="flex flex-wrap gap-4">
              <input type="text" id="prodNome" placeholder="Nome do Produto (Ex: Split Inverter)" required
                class="mt-1 block w-full md:flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="text" id="prodDesc" placeholder="Descrição/Marca"
                class="mt-1 block w-full md:flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="number" id="prodPreco" placeholder="Preço (R$)" required
                class="mt-1 block w-full md:w-32 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="number" id="prodEstoque" placeholder="Estoque" required
                class="mt-1 block w-full md:w-32 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <button onclick="criarProduto()"
                class="flex-shrink-0 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg shadow-sm font-medium transition-colors">
                + Novo Produto
              </button>
            </div>
          </section>

          <!-- Tabela de Produtos -->
          <div class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-100">
            <div class="overflow-x-auto">
              <table class="w-full min-w-max">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nome</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Descrição</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Preço</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Estoque</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ações</th>
                  </tr>
                </thead>
                <tbody id="produtoTable" class="divide-y divide-gray-200 table-body">
                  <!-- JS vai preencher aqui -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- ==== PÁGINA 3: CLIENTES (CRUD) ==== -->
        <!-- Conteúdo migrado do seu arquivo "funcional" e re-estilizado -->
        <div class="page-content hidden" id="page-clientes">
          <!-- Formulário de Criação -->
          <section class="bg-white shadow-lg rounded-lg p-6 mb-8 border border-gray-100">
            <h2 class="text-2xl font-semibold mb-5 text-gray-800">Adicionar Novo Cliente</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              <input type="text" id="cliNome" placeholder="Nome" required
                class="col-span-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="text" id="cliCpf" placeholder="CPF / CNPJ" required
                class="col-span-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="tel" id="cliTel" placeholder="Telefone (WhatsApp)" required
                class="col-span-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="email" id="cliEmail" placeholder="Email"
                class="col-span-1 md:col-span-2 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="number" id="cliRegiao" placeholder="ID Região" required
                class="col-span-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <button onclick="criarCliente()"
                class="col-span-1 md:col-span-3 lg:col-span-1 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg shadow-sm font-medium transition-colors">
                + Novo Cliente
              </button>
            </div>
          </section>

          <!-- Tabela de Clientes -->
          <div class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-100">
            <div class="overflow-x-auto">
              <table class="w-full min-w-max">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nome</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">CPF/CNPJ</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Telefone</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Email</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ações</th>
                  </tr>
                </thead>
                <tbody id="clienteTable" class="divide-y divide-gray-200 table-body">
                  <!-- JS vai preencher aqui -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- ==== PÁGINA 4: VENDEDORES (CRUD) ==== -->
        <!-- Conteúdo migrado do seu arquivo "funcional" e re-estilizado -->
        <div class="page-content hidden" id="page-vendedores">
          <!-- Formulário de Criação -->
          <section class="bg-white shadow-lg rounded-lg p-6 mb-8 border border-gray-100">
            <h2 class="text-2xl font-semibold mb-5 text-gray-800">Adicionar Novo Vendedor</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
              <input type="text" id="vendNome" placeholder="Nome" required
                class="col-span-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="tel" id="vendTel" placeholder="Telefone" required
                class="col-span-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="email" id="vendEmail" placeholder="Email"
                class="col-span-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <input type="number" id="vendRegiao" placeholder="ID Região" required
                class="col-span-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
              <button onclick="criarVendedor()"
                class="col-span-1 md:col-span-4 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg shadow-sm font-medium transition-colors">
                + Novo Vendedor
              </button>
            </div>
          </section>

          <!-- Tabela de Vendedores -->
          <div class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-100">
            <div class="overflow-x-auto">
              <table class="w-full min-w-max">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nome</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Telefone</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Email</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ações</th>
                  </tr>
                </thead>
                <tbody id="vendedorTable" class="divide-y divide-gray-200 table-body">
                  <!-- JS vai preencher aqui -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <!-- ==== PÁGINA 5: RELATÓRIOS ==== -->
        <!-- Conteúdo migrado do seu arquivo "funcional" e re-estilizado -->
        <div class="page-content hidden" id="page-relatorios">
          <div class="space-y-8">
            
            <!-- Card Relatório: Total Vendido por Região -->
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100">
              <h3 class="text-xl font-semibold text-gray-800 mb-4">Total Vendido por Região</h3>
              <div id="relatorioRegiaoTable" class="overflow-x-auto rounded-lg border border-gray-200">
                <table class="w-full text-left text-sm">
                  <thead class="bg-gray-100 text-gray-600">
                    <tr>
                      <th class="p-3">Região</th>
                      <th class="p-3 text-right">Total Vendido (R$)</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-100 table-body">
                    <!-- JS preenche aqui -->
                  </tbody>
                </table>
              </div>
              <button onclick="listarRelatorioTotalVendidoPorRegiao()"
                class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg shadow-sm transition duration-300">
                Gerar Relatório
              </button>
            </div>

            <!-- Card Relatório: Total Vendido por Cliente -->
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100">
              <h3 class="text-xl font-semibold text-gray-800 mb-4">Total Vendido por Cliente</h3>
              <div id="relatorioClienteTable" class="overflow-x-auto rounded-lg border border-gray-200">
                <table class="w-full text-left text-sm">
                  <thead class="bg-gray-100 text-gray-600">
                    <tr>
                      <th class="p-3">ID Cliente</th>
                      <th class="p-3">Nome do Cliente</th>
                      <th class="p-3 text-right">Total Vendido (R$)</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-100 table-body">
                    <!-- JS preenche aqui -->
                  </tbody>
                </table>
              </div>
              <button onclick="listarRelatorioTotalVendidoPorCliente()"
                class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg shadow-sm transition duration-300">
                Gerar Relatório
              </button>
            </div>

            <!-- Card Relatório: Total Vendido por Vendedor -->
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100">
              <h3 class="text-xl font-semibold text-gray-800 mb-4">Total Vendido por Vendedor</h3>
              <div id="relatorioVendedorTable" class="overflow-x-auto rounded-lg border border-gray-200">
                <table class="w-full text-left text-sm">
                  <thead class="bg-gray-100 text-gray-600">
                    <tr>
                      <th class="p-3">ID Vendedor</th>
                      <th class="p-3">Nome do Vendedor</th>
                      <th class="p-3 text-right">Total Vendido (R$)</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-100 table-body">
                    <!-- JS preenche aqui -->
                  </tbody>
                </table>
              </div>
              <button onclick="listarRelatorioTotalVendidoPorVendedor()"
                class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg shadow-sm transition duration-300">
                Gerar Relatório
              </button>
            </div>
            
            <!-- Card Relatório: Total Vendido por Produto -->
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100">
              <h3 class="text-xl font-semibold text-gray-800 mb-4">Total Vendido por Produto</h3>
              <div id="relatorioProdutoTable" class="overflow-x-auto rounded-lg border border-gray-200">
                <table class="w-full text-left text-sm">
                  <thead class="bg-gray-100 text-gray-600">
                    <tr>
                      <th class="p-3">ID Produto</th>
                      <th class="p-3">Nome do Produto</th>
                      <th class="p-3 text-right">Total Vendido (R$)</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-100 table-body">
                    <!-- JS preenche aqui -->
                  </tbody>
                </table>
              </div>
              <button onclick="listarRelatorioTotalVendidoPorProduto()"
                class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg shadow-sm transition duration-300">
                Gerar Relatório
              </button>
            </div>

            <!-- Card Relatório: Filtro por Região -->
            <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-100">
              <h3 class="text-xl font-semibold text-gray-800 mb-4">Filtro por Região</h3>
              <div class="flex flex-wrap gap-4 items-end mb-6">
                <input type="number" id="relatorioFiltroRegiaoId" placeholder="ID da Região (Ex: 1)" required
                  class="border border-gray-300 rounded-lg p-3 w-40 focus:ring-2 focus:ring-blue-500 transition duration-200">
                <button onclick="listarRelatorioVendedoresPorRegiao()"
                  class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg shadow-sm transition duration-300">
                  Filtrar Vendedores
                </button>
                <button onclick="listarRelatorioClientesPorRegiao()"
                  class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg shadow-sm transition duration-300">
                  Filtrar Clientes
                </button>
              </div>

              <h4 class="text-lg font-semibold text-gray-700 mt-5 mb-2">Vendedores da Região:</h4>
              <div id="relatorioVendedoresRegiaoTable" class="overflow-x-auto rounded-lg border border-gray-200">
                <table class="w-full text-left text-sm">
                  <thead class="bg-gray-100 text-gray-600">
                    <tr>
                      <th class="p-3">ID Vendedor</th>
                      <th class="p-3">Nome</th>
                      <th class="p-3">Telefone</th>
                    </tr>
                  </thead>
                  <tbody id="tabelaVendedores" class="divide-y divide-gray-100 table-body">
                    <!-- JS preenche aqui -->
                  </tbody>
                </table>
              </div>

              <h4 class="text-lg font-semibold text-gray-700 mt-5 mb-2">Clientes da Região:</h4>
              <div id="relatorioClientesRegiaoTable" class="overflow-x-auto rounded-lg border border-gray-200">
                <table class="w-full text-left text-sm">
                  <thead class="bg-gray-100 text-gray-600">
                    <tr>
                      <th class="p-3">ID Cliente</th>
                      <th class="p-3">Nome</th>
                      <th class="p-3">Telefone</th>
                    </tr>
                  </thead>
                  <tbody id="tabelaClientes" class="divide-y divide-gray-100 table-body">
                    <!-- JS preenche aqui -->
                  </tbody>
                </table>
              </div>
            </div>

          </div>
        </div>

      </main>
    </div>
  </div>

  <!-- ADICIONADO: Modal de Edição (HTML do seu JS "funcional") -->
  <div id="modalEditar"
    class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm p-4">
    <div class="bg-white w-full max-w-lg p-6 rounded-lg shadow-xl">
      <div class="flex justify-between items-center mb-4">
        <h2 id="modalTitle" class="text-2xl font-bold text-gray-800">Editar Registro</h2>
        <button onclick="fecharModal()" class="text-gray-400 hover:text-gray-600">
          <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Formulário de Edição -->
      <form id="formEditar">
        <div id="camposEditar" class="space-y-4">
          <!-- Campos serão preenchidos dinamicamente pelo JS -->
        </div>
        
        <!-- Botões do Formulário -->
        <div class="mt-6 flex justify-end space-x-4">
          <button type="button" onclick="fecharModal()"
            class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
            Cancelar
          </button>
          <button type="submit"
            class="px-4 py-2 bg-blue-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-blue-700">
            Salvar Alterações
          </button>
        </div>
      </form>
    </div>
  </div>


  <!-- ======================================================= -->
  <!-- SEU SCRIPT FUNCIONAL (LIMPO, UNIFICADO E CORRIGIDO) -->
  <!-- ======================================================= -->
  <script>
    const apiProduto = "http://127.0.0.1:8000/produto/";
    const apiCliente = "http://127.0.0.1:8000/cliente/";
    const apiVendedor = "http://127.0.0.1:8000/vendedor/";
    // APIs de Relatório (do seu código)
    const apiRelatorioRegiao = "http://127.0.0.1:8000/relatorio/regiao";
    const apiRelatorioCliente = "http://127.0.0.1:8000/relatorio/cliente";
    const apiRelatorioVendedor = "http://127.0.0.1:8000/relatorio/vendedor";
    const apiRelatorioProduto = "http://127.0.0.1:8000/relatorio/produto";
    // APIs de Filtro (do seu código)
    const apiRelatorioVendedoresRegiao = "http://127.0.0.1:8000/relatorio/regiao/"; // (será completado com /id/vendedores)
    const apiRelatorioClientesRegiao = "http://127.0.0.1:8000/relatorio/regiao/"; // (será completado com /id/clientes)

    // ---------------- UTILS (Máscaras e Modal) ----------------
    function phoneMask(value) {
      if (!value) return "";
      value = value.replace(/\D/g, "").substring(0, 11);
      if (value.length > 10) {
        value = value.replace(/(\d{2})(\d{5})(\d{4})/, "($1) $2-$3");
      } else if (value.length > 6) {
        value = value.replace(/(\d{2})(\d{4})(\d{0,4})/, "($1) $2-$3");
      } else if (value.length > 2) {
        value = value.replace(/(\d{2})(\d{0,5})/, "($1) $2");
      }
      return value;
    }

    function cpfCnpjMask(value) {
      if (!value) return "";
      value = value.replace(/\D/g, "").substring(0, 14);
      if (value.length <= 11) {
        value = value.replace(/(\d{3})(\d)/, "$1.$2");
        value = value.replace(/(\d{3})(\d)/, "$1.$2");
        value = value.replace(/(\d{3})(\d{1,2})$/, "$1-$2");
      } else {
        value = value.replace(/^(\d{2})(\d)/, "$1.$2");
        value = value.replace(/^(\d{2})\.(\d{3})(\d)/, "$1.$2.$3");
        value = value.replace(/\.(\d{3})(\d)/, ".$1/$2");
        value = value.replace(/(\d{4})(\d)/, "$1-$2");
      }
      return value;
    }
    
    // Aplica máscaras aos inputs de Cliente e Vendedor (quando existirem)
    // Usamos 'input' (evento) para aplicar a máscara enquanto digita
    document.addEventListener('input', (e) => {
        if(e.target.id === 'cliTel' || e.target.id === 'vendTel') {
            e.target.value = phoneMask(e.target.value);
        }
        if(e.target.id === 'cliCpf') {
            e.target.value = cpfCnpjMask(e.target.value);
        }
    });

    // Lógica do Modal de Edição
    let registroAtual = { tipo: null, id: null };

    function fecharModal() {
      document.getElementById("modalEditar").classList.add("hidden");
      registroAtual = { tipo: null, id: null };
    }

    async function editarRegistro(tipo, id) {
      registroAtual.tipo = tipo;
      registroAtual.id = id;

      const modal = document.getElementById("modalEditar");
      const title = document.getElementById("modalTitle");
      const campos = document.getElementById("camposEditar");
      campos.innerHTML = ""; // limpa campos anteriores

      let data;
      let apiUrl;

      switch (tipo) {
        case "Produto": apiUrl = `${apiProduto}${id}`; break;
        case "Cliente": apiUrl = `${apiCliente}${id}`; break;
        case "Vendedor": apiUrl = `${apiVendedor}${id}`; break;
      }

      try {
        const res = await fetch(apiUrl);
        data = await res.json();

        // Cria campos dinâmicos (estilizados com Tailwind)
        const baseInputClass = "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500";
        
        if (tipo === "Produto") {
          campos.innerHTML = `
            <div><label class="text-sm font-medium text-gray-700">Nome:</label> <input type="text" name="ProdNome" value="${data.ProdNome}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">Descrição:</label> <input type="text" name="proddescricao" value="${data.proddescricao || ''}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">Preço:</label> <input type="number" step="0.01" name="Prodpreco" value="${data.Prodpreco}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">Estoque:</label> <input type="number" name="Prodestoque" value="${data.Prodestoque}" class="${baseInputClass}"></div>
          `;
        } else if (tipo === "Cliente") {
          campos.innerHTML = `
            <div><label class="text-sm font-medium text-gray-700">Nome:</label> <input type="text" name="clinome" value="${data.clinome}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">CPF/CNPJ:</label> <input type="text" id="editCliCpf" name="clicpf_cnpj" value="${data.clicpf_cnpj}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">Telefone:</label> <input type="text" id="editCliTel" name="clitelefone" value="${data.clitelefone || ''}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">Email:</label> <input type="text" name="cliemail" value="${data.cliemail || ''}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">Região (ID):</label> <input type="number" name="idregiao" value="${data.idregiao}" class="${baseInputClass}"></div>
          `;
          // Aplica máscaras nos campos do modal
          document.getElementById('editCliTel').addEventListener('input', (e) => e.target.value = phoneMask(e.target.value));
          document.getElementById('editCliCpf').addEventListener('input', (e) => e.target.value = cpfCnpjMask(e.target.value));

        } else if (tipo === "Vendedor") {
          campos.innerHTML = `
            <div><label class="text-sm font-medium text-gray-700">Nome:</label> <input type="text" name="Vendnome" value="${data.Vendnome}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">Telefone:</label> <input type="text" id="editVendTel" name="VendTelefone" value="${data.VendTelefone || ''}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">Email:</label> <input type="text" name="VendEmail" value="${data.VendEmail || ''}" class="${baseInputClass}"></div>
            <div><label class="text-sm font-medium text-gray-700">Região (ID):</label> <input type="number" name="idregiao" value="${data.idregiao}" class="${baseInputClass}"></div>
          `;
          // Aplica máscara
          document.getElementById('editVendTel').addEventListener('input', (e) => e.target.value = phoneMask(e.target.value));
        }

        title.innerText = `Editar ${tipo} (ID: ${id})`;
        modal.classList.remove("hidden");
      } catch (err) {
        alert("Erro ao carregar os dados para edição.");
        console.error(err);
      }
    }

    // Captura o submit do modal de edição
    document.getElementById("formEditar").addEventListener("submit", async function (e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const body = Object.fromEntries(formData.entries());

      let apiUrl;
      switch (registroAtual.tipo) {
        case "Produto": apiUrl = `${apiProduto}${registroAtual.id}`; break;
        case "Cliente": apiUrl = `${apiCliente}${registroAtual.id}`; break;
        case "Vendedor": apiUrl = `${apiVendedor}${registroAtual.id}`; break;
      }

      try {
        await fetch(apiUrl, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body),
        });
        fecharModal();
        // Recarrega a lista correspondente
        if (registroAtual.tipo === "Produto") listarProdutos();
        if (registroAtual.tipo === "Cliente") listarClientes();
        if (registroAtual.tipo === "Vendedor") listarVendedores();
      } catch (err) {
        alert("Erro ao salvar alterações.");
        console.error(err);
      }
    });

    // ---------------- PRODUTO (CRUD) ----------------
    async function listarProdutos() {
      try {
        const res = await fetch(apiProduto);
        if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
        const produtos = await res.json();
        const tbody = document.getElementById("produtoTable");
        tbody.innerHTML = "";
        document.getElementById('total-produtos').textContent = produtos.length; // Atualiza card
        
        if (produtos.length === 0) {
            tbody.innerHTML = `<tr><td colspan="6" class="p-4 text-center text-gray-500">Nenhum produto cadastrado.</td></tr>`;
            return;
        }

        produtos.forEach((p) => {
          const estoqueClass = p.Prodestoque < 10 ? "text-red-600 font-semibold" : "text-gray-800";
          const tr = document.createElement("tr");
          tr.className = 'hover:bg-gray-50';
          tr.innerHTML = `
            <td class='px-6 py-4 text-sm text-gray-800'>${p.idProduto}</td>
            <td class='px-6 py-4 text-sm font-medium text-gray-900'>${p.ProdNome}</td>
            <td class='px-6 py-4 text-sm text-gray-600 truncate' style="max-width: 200px;">${p.proddescricao || "N/A"}</td>
            <td class='px-6 py-4 text-sm text-green-700 font-medium'>R$ ${parseFloat(p.Prodpreco).toFixed(2)}</td>
            <td class='px-6 py-4 text-sm ${estoqueClass}'>${p.Prodestoque}</td>
            <td class='px-6 py-4 text-sm flex space-x-3'>
              <button onclick="editarRegistro('Produto', ${p.idProduto})" class='text-blue-600 hover:text-blue-800' title="Editar">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg>
              </button>
              <button onclick="deletarProduto(${p.idProduto})" class='text-red-600 hover:text-red-800' title="Excluir">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
              </button>
            </td>`;
          tbody.appendChild(tr);
        });
      } catch (error) {
        console.error("Erro ao listar produtos:", error);
        document.getElementById("produtoTable").innerHTML =
          '<tr><td colspan="6" class="p-4 text-center text-red-500 font-bold">⚠️ Erro ao carregar dados da API. Verifique a URL e o backend.</td></tr>';
      }
    }

    async function criarProduto() {
      const nome = prodNome.value.trim(), desc = prodDesc.value.trim();
      const preco = parseFloat(prodPreco.value), estoque = parseInt(prodEstoque.value);
      if (!nome || isNaN(preco) || isNaN(estoque)) {
        alert("Preencha nome, preço e estoque corretamente!");
        return;
      }
      try {
        await fetch(apiProduto, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ ProdNome: nome, proddescricao: desc, Prodpreco: preco, Prodestoque: estoque }),
        });
        prodNome.value = prodDesc.value = prodPreco.value = prodEstoque.value = "";
        listarProdutos();
      } catch (error) {
        alert("Erro ao criar produto. Verifique a conexão com a API.");
      }
    }

    async function deletarProduto(id) {
      if (confirm(`Tem certeza que deseja deletar o Produto ID ${id}? Esta ação é IRREVERSÍVEL.`)) {
        try {
          await fetch(`${apiProduto}${id}`, { method: "DELETE" });
          listarProdutos();
        } catch (error) {
          alert("Erro ao deletar produto.");
        }
      }
    }

    // ---------------- CLIENTE (CRUD) ----------------
    async function listarClientes() {
      try {
        const res = await fetch(apiCliente);
        if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
        const clientes = await res.json();
        const tbody = document.getElementById("clienteTable");
        tbody.innerHTML = "";
        document.getElementById('total-clientes').textContent = clientes.length; // Atualiza card
        
        if (clientes.length === 0) {
            tbody.innerHTML = `<tr><td colspan="6" class="p-4 text-center text-gray-500">Nenhum cliente cadastrado.</td></tr>`;
            return;
        }

        clientes.forEach((c) => {
          const tr = document.createElement("tr");
          tr.className = 'hover:bg-gray-50';
          tr.innerHTML = `
            <td class='px-6 py-4 text-sm text-gray-800'>${c.idCliente}</td>
            <td class='px-6 py-4 text-sm font-medium text-gray-900'>${c.clinome}</td>
            <td class='px-6 py-4 text-sm text-gray-600'>${c.clicpf_cnpj}</td>
            <td class='px-6 py-4 text-sm text-gray-600'>${c.clitelefone || "N/A"}</td>
            <td class='px-6 py-4 text-sm text-gray-600'>${c.cliemail || "N/A"}</td>
            <td class='px-6 py-4 text-sm flex space-x-3'>
              <button onclick="editarRegistro('Cliente', ${c.idCliente})" class='text-blue-600 hover:text-blue-800' title="Editar">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg>
              </button>
              <button onclick="deletarCliente(${c.idCliente})" class='text-red-600 hover:text-red-800' title="Excluir">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
              </button>
            </td>`;
          tbody.appendChild(tr);
        });
      } catch (error) {
        console.error("Erro ao listar clientes:", error);
        document.getElementById("clienteTable").innerHTML =
          '<tr><td colspan="6" class="p-4 text-center text-red-500 font-bold">⚠️ Erro ao carregar dados da API. Verifique a URL e o backend.</td></tr>';
      }
    }

    async function criarCliente() {
      const nome = cliNome.value.trim();
      const cpf = cliCpf.value.trim();
      const tel = cliTel.value.trim();
      const email = cliEmail.value.trim();
      const regiao = parseInt(cliRegiao.value);
      if (!nome || !cpf || !tel || isNaN(regiao)) {
        alert("Preencha nome, CPF/CNPJ, telefone e ID Região!");
        return;
      }
      try {
        await fetch(apiCliente, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ clinome: nome, clicpf_cnpj: cpf, clitelefone: tel, cliemail: email, idregiao: regiao }),
        });
        cliNome.value = cliCpf.value = cliTel.value = cliEmail.value = cliRegiao.value = "";
        listarClientes();
      } catch (error) {
        alert("Erro ao criar cliente. Verifique a conexão com a API.");
      }
    }

    async function deletarCliente(idCliente) {
      if (confirm(`Tem certeza que deseja deletar o Cliente ID ${idCliente}? Esta ação é IRREVERSÍVEL.`)) {
        try {
          await fetch(`${apiCliente}${idCliente}`, { method: "DELETE" });
          listarClientes();
        } catch (error) {
          alert("Erro ao deletar cliente.");
        }
      }
    }

    // ---------------- VENDEDOR (CRUD) ----------------
    async function listarVendedores() {
      try {
        const res = await fetch(apiVendedor);
        if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
        const vendedores = await res.json();
        const tbody = document.getElementById("vendedorTable");
        tbody.innerHTML = "";
        document.getElementById('total-vendedores').textContent = vendedores.length; // Atualiza card

        if (vendedores.length === 0) {
            tbody.innerHTML = `<tr><td colspan="5" class="p-4 text-center text-gray-500">Nenhum vendedor cadastrado.</td></tr>`;
            return;
        }

        vendedores.forEach((v) => {
          const tr = document.createElement("tr");
          tr.className = 'hover:bg-gray-50';
          tr.innerHTML = `
            <td class='px-6 py-4 text-sm text-gray-800'>${v.idVendedor}</td>
            <td class='px-6 py-4 text-sm font-medium text-gray-900'>${v.Vendnome}</td>
            <td class='px-6 py-4 text-sm text-gray-600'>${v.VendTelefone || "N/A"}</td>
            <td class='px-6 py-4 text-sm text-gray-600'>${v.VendEmail || "N/A"}</td>
            <td class='px-6 py-4 text-sm flex space-x-3'>
              <button onclick="editarRegistro('Vendedor', ${v.idVendedor})" class='text-blue-600 hover:text-blue-800' title="Editar">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg>
              </button>
              <button onclick="deletarVendedor(${v.idVendedor})" class='text-red-600 hover:text-red-800' title="Excluir">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
              </button>
            </td>`;
          tbody.appendChild(tr);
        });
      } catch (error) {
        console.error("Erro ao listar vendedores:", error);
        document.getElementById("vendedorTable").innerHTML =
          '<tr><td colspan="5" class="p-4 text-center text-red-500 font-bold">⚠️ Erro ao carregar dados da API. Verifique a URL e o backend.</td></tr>';
      }
    }

    async function criarVendedor() {
      const nome = vendNome.value.trim(),
        tel = vendTel.value.trim(),
        email = vendEmail.value.trim(),
        regiao = parseInt(vendRegiao.value);
      if (!nome || !tel || isNaN(regiao)) {
        alert("Preencha nome, telefone e ID Região!");
        return;
      }
      try {
        await fetch(apiVendedor, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ Vendnome: nome, VendTelefone: tel, VendEmail: email, idregiao: regiao }),
        });
        vendNome.value = vendTel.value = vendEmail.value = vendRegiao.value = "";
        listarVendedores();
      } catch (error) {
        alert("Erro ao criar vendedor. Verifique a conexão com a API.");
      }
    }

    async function deletarVendedor(id) {
      if (confirm(`Tem certeza que deseja deletar o Vendedor ID ${id}? Esta ação é IRREVERSÍVEL.`)) {
        try {
          await fetch(`${apiVendedor}${id}`, { method: "DELETE" });
          listarVendedores();
        } catch (error) {
          alert("Erro ao deletar vendedor.");
        }
      }
    }

    // ================= RELATÓRIOS =================
    
    // Função genérica para preencher tabelas de relatório
    function preencherTabelaRelatorio(tbodyId, dados, colunas) {
        const tbody = document.getElementById(tbodyId) || document.querySelector(tbodyId); // Suporta ID ou Seletor
        if (!tbody) {
            console.error(`Tabela ${tbodyId} não encontrada!`);
            return;
        }
        tbody.innerHTML = "";
        if (dados.length === 0) {
            tbody.innerHTML = `<tr><td colspan="${colunas.length}" class="p-3 text-center text-gray-500">Nenhum dado encontrado.</td></tr>`;
            return;
        }
        dados.forEach((item) => {
            const tr = document.createElement('tr');
            colunas.forEach(col => {
                const td = document.createElement('td');
                td.className = `p-3 ${col.classe || ''}`;
                let valor = item[col.chave];
                if (col.format === 'reais') {
                    valor = `R$ ${parseFloat(valor).toFixed(2)}`;
                }
                td.textContent = valor || (col.fallback || 'N/A');
                tr.appendChild(td);
            });
            tbody.appendChild(tr);
        });
    }

    // REGIÃO
    async function listarRelatorioTotalVendidoPorRegiao() {
      const tbodyId = "#relatorioRegiaoTable tbody";
      try {
        const res = await fetch(apiRelatorioRegiao);
        const dados = await res.json();
        preencherTabelaRelatorio(tbodyId, dados, [
          { chave: 'nome', classe: 'text-left' },
          { chave: 'total', classe: 'text-right font-bold text-green-700', format: 'reais' }
        ]);
      } catch(error) {
        console.error("Erro Relatório Região:", error);
        document.querySelector(tbodyId).innerHTML = '<tr><td colspan="2" class="p-3 text-center text-red-500 font-bold">⚠️ Erro ao carregar.</td></tr>';
      }
    }

    // CLIENTE
    async function listarRelatorioTotalVendidoPorCliente() {
      const tbodyId = "#relatorioClienteTable tbody";
      try {
        const res = await fetch(apiRelatorioCliente);
        const dados = await res.json();
        preencherTabelaRelatorio(tbodyId, dados, [
          { chave: 'id', classe: 'text-left' },
          { chave: 'nome', classe: 'text-left' },
          { chave: 'total', classe: 'text-right font-bold text-green-700', format: 'reais' }
        ]);
      } catch(error) {
        console.error("Erro Relatório Cliente:", error);
        document.querySelector(tbodyId).innerHTML = '<tr><td colspan="3" class="p-3 text-center text-red-500 font-bold">⚠️ Erro ao carregar.</td></tr>';
      }
    }

    // VENDEDOR
    async function listarRelatorioTotalVendidoPorVendedor() {
      const tbodyId = "#relatorioVendedorTable tbody";
      try {
        const res = await fetch(apiRelatorioVendedor);
        const dados = await res.json();
        preencherTabelaRelatorio(tbodyId, dados, [
          { chave: 'id', classe: 'text-left' },
          { chave: 'nome', classe: 'text-left' },
          { chave: 'total', classe: 'text-right font-bold text-green-700', format: 'reais' }
        ]);
      } catch(error) {
        console.error("Erro Relatório Vendedor:", error);
        document.querySelector(tbodyId).innerHTML = '<tr><td colspan="3" class="p-3 text-center text-red-500 font-bold">⚠️ Erro ao carregar.</td></tr>';
      }
    }
    
    // PRODUTO
    async function listarRelatorioTotalVendidoPorProduto() {
      const tbodyId = "#relatorioProdutoTable tbody";
      try {
        const res = await fetch(apiRelatorioProduto);
        const dados = await res.json();
        preencherTabelaRelatorio(tbodyId, dados, [
          { chave: 'id', classe: 'text-left' },
          { chave: 'nome', classe: 'text-left' },
          { chave: 'total', classe: 'text-right font-bold text-green-700', format: 'reais' }
        ]);
      } catch(error) {
        console.error("Erro Relatório Produto:", error);
        document.querySelector(tbodyId).innerHTML = '<tr><td colspan="3" class="p-3 text-center text-red-500 font-bold">⚠️ Erro ao carregar.</td></tr>';
      }
    }

    // FILTRAR VENDEDORES POR REGIÃO
    async function listarRelatorioVendedoresPorRegiao() {
      // CORREÇÃO: Buscando pelo ID correto do HTML
      const idInput = document.getElementById("relatorioFiltroRegiaoId").value;
      const id = parseInt(idInput);
      if (isNaN(id)) {
        alert("Por favor, insira um ID de Região válido.");
        return;
      }
      
      const tbodyId = "tabelaVendedores"; // ID da tbody de vendedores por região
      try {
        const res = await fetch(`${apiRelatorioVendedoresRegiao}${id}/vendedores`);
        if (!res.ok) throw new Error("Erro na requisição");
        const dados = await res.json();
        preencherTabelaRelatorio(tbodyId, dados, [
          { chave: 'id', classe: 'text-left' },
          { chave: 'nome', classe: 'text-left' },
          { chave: 'telefone', classe: 'text-left', fallback: '-' }
        ]);
      } catch (error) {
        console.error(error);
        document.getElementById(tbodyId).innerHTML = `<tr><td colspan="3" class="p-3 text-center text-red-500 font-bold">⚠️ Erro ao carregar.</td></tr>`;
      }
    }

    // FILTRAR CLIENTES POR REGIÃO
    async function listarRelatorioClientesPorRegiao() {
      // CORREÇÃO: Buscando pelo ID correto do HTML
      const idInput = document.getElementById("relatorioFiltroRegiaoId").value;
      const id = parseInt(idInput);
      if (isNaN(id)) {
        alert("Por favor, insira um ID de Região válido.");
        return;
      }

      const tbodyId = "tabelaClientes"; // ID da tbody de clientes por região
      try {
        const res = await fetch(`${apiRelatorioClientesRegiao}${id}/clientes`);
        if (!res.ok) throw new Error("Erro na requisição");
        const dados = await res.json();
        preencherTabelaRelatorio(tbodyId, dados, [
          { chave: 'id', classe: 'text-left' },
          { chave: 'nome', classe: 'text-left' },
          { chave: 'telefone', classe: 'text-left', fallback: '-' }
        ]);
      } catch (error) {
        console.error(error);
        document.getElementById(tbodyId).innerHTML = `<tr><td colspan="3" class="p-3 text-center text-red-500 font-bold">⚠️ Erro ao carregar.</td></tr>`;
      }
    }

    // =======================================================
    // LÓGICA DA UI (DO NOSSO TEMPLATE OFICIAL)
    // =======================================================
    document.addEventListener('DOMContentLoaded', () => {
      const navLinks = document.querySelectorAll('.nav-link');
      const pages = document.querySelectorAll('.page-content');
      const pageTitle = document.getElementById('page-title');
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('sidebar-overlay');
      const menuToggleBtn = document.getElementById('menu-toggle-btn');
      const userMenuButton = document.getElementById('user-menu-button');
      const userMenuDropdown = document.getElementById('user-menu-dropdown');

      // --- Lógica de Navegação (SPA) ---
      navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const targetId = link.getAttribute('data-target');
          const targetPage = document.getElementById(targetId);
          const targetTitle = link.textContent.trim();

          pages.forEach(page => page.classList.add('hidden'));
          if (targetPage) {
            targetPage.classList.remove('hidden');
          }
          pageTitle.textContent = targetTitle;

          navLinks.forEach(nav => {
            nav.classList.remove('bg-blue-50', 'border-blue-600', 'text-gray-700', 'font-medium');
            nav.classList.add('text-gray-600', 'hover:bg-gray-50', 'border-transparent');
          });
          link.classList.add('bg-blue-50', 'border-blue-600', 'text-gray-700', 'font-medium');
          link.classList.remove('text-gray-600', 'hover:bg-gray-50', 'border-transparent');

          if (window.innerWidth < 768) {
            toggleMobileMenu();
          }
        });
      });

      // --- Lógica do Menu Mobile ---
      function toggleMobileMenu() {
        if (sidebar && overlay) {
          sidebar.classList.toggle('-translate-x-full');
          overlay.classList.toggle('hidden');
        }
      }
      if (menuToggleBtn) menuToggleBtn.addEventListener('click', toggleMobileMenu);
      if (overlay) overlay.addEventListener('click', toggleMobileMenu);

      // --- Lógica do Dropdown de Usuário ---
      if (userMenuButton) {
        userMenuButton.addEventListener('click', () => {
          userMenuDropdown.classList.toggle('hidden');
        });
      }
      window.addEventListener('click', (e) => {
        if (userMenuButton && userMenuDropdown) {
          if (!userMenuButton.contains(e.target) && !userMenuDropdown.contains(e.target)) {
            userMenuDropdown.classList.add('hidden');
          }
        }
      });

      // --- INICIALIZAÇÃO DOS DADOS ---
      // Carrega os dados das 3 seções principais ao iniciar
      listarProdutos();
      listarClientes();
      listarVendedores();
    });
  </script>

</body>
</html>